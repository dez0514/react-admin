import{d as A,r as a,j as e,P as V,l as m,I as B,at as F,au as r,s as o,B as p,av as j,T as K,i as W,aw as z,y as G}from"./index-988698c9.js";import{g as H}from"./table-8e154786.js";import{D as J}from"./index-b50591e3.js";const{Item:n}=m;function U(){A("Excel导出");const[d,f]=a.useState([]),[y,v]=a.useState([]),[c,x]=a.useState([]),[w,u]=a.useState(!1),[h,S]=a.useState(!0),[T,b]=a.useState("excel-file"),[k,I]=a.useState("xlsx"),C=()=>{H().then(t=>{if(t.code===0){const s=t.data.map((l,i)=>({...l,key:String(i)}));f(s)}})},_=t=>{b(t.target.value)},E=t=>{S(t.target.value)},R=t=>{console.log("vvvv===",t),I(t)},D=(t,s)=>{x(t),v(s)},L=(t,s)=>s.map(l=>t.map(i=>l[i])),g=t=>{if(t==="selected"&&c.length===0){W.error("至少选择一项进行导出");return}u(!0),z(()=>import("./Export2Excel-17135665.js"),["assets/Export2Excel-17135665.js","assets/FileSaver.min-c42d9283.js","assets/index-988698c9.js","assets/index-394a82ac.css"]).then(s=>{const l=["Id","Title","Author","Readings","Date"],P=L(["id","title","author","readings","date"],t==="all"?d:y);s.export_json_to_excel({header:l,data:P,filename:T,autoWidth:h,bookType:k}),u(!1),x([])})};a.useEffect(()=>{C()},[]);const O=[{title:"Id",dataIndex:"id",key:"id",width:200,align:"center"},{title:"Title",dataIndex:"title",key:"title",width:200,align:"center"},{title:"Author",key:"author",dataIndex:"author",width:100,align:"center",render:t=>e.jsx(G,{children:t},t)},{title:"Readings",dataIndex:"readings",key:"readings",width:195,align:"center"},{title:"Date",dataIndex:"date",key:"date",width:195,align:"center"}];return e.jsxs(V,{children:[e.jsx("div",{style:{marginTop:"20px"},children:e.jsxs(m,{layout:"inline",children:[e.jsx(n,{label:"文件名:",children:e.jsx(B,{style:{width:"250px"},prefix:e.jsx(F,{style:{color:"rgba(0,0,0,.25)"}}),placeholder:"请输入文件名(默认excel-file)",onChange:_})}),e.jsx(n,{label:"单元格宽度是否自适应:",children:e.jsxs(r.Group,{onChange:E,value:h,children:[e.jsx(r,{value:!0,children:"是"}),e.jsx(r,{value:!1,children:"否"})]})}),e.jsx(n,{label:"文件类型:",children:e.jsxs(o,{defaultValue:"xlsx",style:{width:120},onChange:R,children:[e.jsx(o.Option,{value:"xlsx",children:"xlsx"}),e.jsx(o.Option,{value:"csv",children:"csv"}),e.jsx(o.Option,{value:"txt",children:"txt"})]})}),e.jsx(n,{children:e.jsx(p,{type:"primary",icon:e.jsx(j,{}),onClick:()=>g("all"),children:"全部导出"})}),e.jsx(n,{children:e.jsx(p,{type:"primary",icon:e.jsx(j,{}),onClick:()=>g("selected"),children:"导出选择项"})})]})}),e.jsx(J,{}),e.jsx(K,{bordered:!0,size:"small",columns:O,rowKey:t=>t.id,dataSource:d,pagination:{pageSize:10},rowSelection:{selectedRowKeys:c,onChange:D},loading:w})]})}export{U as default};

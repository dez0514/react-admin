var d=Object.defineProperty;var u=(s,t,e)=>t in s?d(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var n=(s,t,e)=>(u(s,typeof t!="symbol"?t+"":t,e),e);import{r as h,j as a,C as p}from"./index-e1458059.js";class f{constructor(t){n(this,"opts");n(this,"source");n(this,"output");n(this,"delay");n(this,"chain");n(this,"done");n(this,"timer");this.opts=t||{},this.source=t.source,this.output=t.output,this.delay=t.delay||120,this.chain={parent:null,dom:this.output,val:[]},(!this.opts.done||typeof this.opts.done!="function")&&(this.opts.done=function(){})}init(){this.chain.val=this.convert(this.source,this.chain.val)}convert(t,e){var o;let i=Array.from(t.childNodes);for(let l=0;l<i.length;l++){let r=i[l];if(r.nodeType===3)e=e.concat((o=r==null?void 0:r.nodeValue)==null?void 0:o.split(""));else if(r.nodeType===1){let c=[];c=this.convert(r,c),e.push({dom:r,val:c})}}return e}print(t,e,i){let o=this;this.timer=setTimeout(function(){o.destory(),t.appendChild(document.createTextNode(e)),i()},this.delay)}destory(){this.timer&&clearTimeout(this.timer)}play(t){if(!t.val.length){t.parent?this.play(t.parent):this.opts.done&&this.opts.done();return}let e=t.val.shift();if(typeof e=="string")this.print(t.dom,e,()=>{this.play(t)});else{let i=e.dom.cloneNode();t.dom.appendChild(i),this.play({parent:t,dom:i,val:e.val})}}start(){this.init(),console.log("chain===",this.chain),this.play(this.chain)}}const v=s=>{const{title:t,source:e}=s,i=h.useRef(null),o=h.useRef(null);return h.useEffect(()=>{const l=new f({source:i.current,output:o.current,delay:30});return l.start(),()=>{l.destory()}},[]),a.jsxs(p,{bordered:!1,className:"card-item",title:t,children:[a.jsx("div",{style:{display:"none"},ref:i,dangerouslySetInnerHTML:{__html:e}}),a.jsx("div",{ref:o})]})};function g(s){return a.jsx("div",{style:{margin:"20px",...s.style},children:s.children})}export{g as P,v as T};
